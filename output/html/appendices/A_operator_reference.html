<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ComputoPermuto Book - Appendix A_operator_reference</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../style.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">ComputoPermuto Book - Appendix
A_operator_reference</h1>
</header>
<h2 id="appendix-a-complete-operator-reference"><strong>Appendix A:
Complete Operator Reference</strong></h2>
<p>This appendix provides a quick reference for all 27 operators
available in Computo.</p>
<h3 id="data-access-scoping">Data Access &amp; Scoping</h3>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>let</code> Binds variables to expressions for use within
a scoped body. * <strong>Syntax:</strong>
<code>["let", [["var1", &lt;expr1&gt;], ...], &lt;body_expr&gt;]</code>
* <strong>Example:</strong>
<code>["let", [["x", 5]], ["+", ["$", "/x"], 10]]</code> -&gt;
<code>15</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>$</code> Retrieves the value of a variable defined by
<code>let</code>. * <strong>Syntax:</strong>
<code>["$", "/variable_name"]</code> * <strong>Example:</strong>
<code>["let", [["x", 5]], ["$", "/x"]]</code> -&gt; <code>5</code></td>
</tr>
</tbody>
</table>
<h4 id="get"><code>get</code></h4>
<p>Retrieves a value from a JSON object or array using a JSON Pointer. *
<strong>Syntax:</strong>
<code>["get", &lt;object_expr&gt;, &lt;json_pointer_string&gt;]</code> *
<strong>Example:</strong>
<code>["get", {"obj": {"a": 1}}, "/obj/a"]</code> -&gt;
<code>1</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>$input</code> Returns the entire input JSON document that
was provided to the script (equivalent to the first input when multiple
inputs are provided). * <strong>Syntax:</strong> <code>["$input"]</code>
* <strong>Example:</strong> If <code>input.json</code> is
<code>{"id": 1}</code>, <code>["$input"]</code> -&gt;
<code>{"id": 1}</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>$inputs</code> Returns an array containing all input JSON
documents that were provided to the script. * <strong>Syntax:</strong>
<code>["$inputs"]</code> * <strong>Example:</strong> If called with
<code>input1.json</code> and <code>input2.json</code>, returns
<code>[&lt;input1_content&gt;, &lt;input2_content&gt;]</code></td>
</tr>
<tr class="even">
<td>### Logic &amp; Control Flow</td>
</tr>
</tbody>
</table>
<h4 id="if"><code>if</code></h4>
<p>Evaluates a condition and returns one of two expressions. *
<strong>Syntax:</strong>
<code>["if", &lt;condition&gt;, &lt;then_expr&gt;, &lt;else_expr&gt;]</code>
* <strong>Example:</strong> <code>["if", true, "Yes", "No"]</code> -&gt;
<code>"Yes"</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>==</code>, <code>!=</code>, <code>&gt;</code>,
<code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> Perform a
comparison between two values. Math comparisons require numbers. *
<strong>Syntax:</strong>
<code>["&lt;op&gt;", &lt;expr1&gt;, &lt;expr2&gt;]</code> *
<strong>Example:</strong> <code>["&gt;", 10, 5]</code> -&gt;
<code>true</code> * <strong>Example:</strong>
<code>["==", "a", "a"]</code> -&gt; <code>true</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>approx</code> Checks if two numbers are approximately
equal within a given epsilon. * <strong>Syntax:</strong>
<code>["approx", &lt;num1_expr&gt;, &lt;num2_expr&gt;, &lt;epsilon_expr&gt;]</code>
* <strong>Example:</strong> <code>["approx", 3.14, 3.141, 0.01]</code>
-&gt; <code>true</code></td>
</tr>
<tr class="even">
<td>### Data Construction &amp; Manipulation</td>
</tr>
</tbody>
</table>
<h4 id="obj"><code>obj</code></h4>
<p>Creates a JSON object from key-value pairs. *
<strong>Syntax:</strong>
<code>["obj", ["key1", &lt;val1&gt;], ["key2", &lt;val2&gt;], ...]</code>
* <strong>Example:</strong> <code>["obj", ["a", 1], ["b", 2]]</code>
-&gt; <code>{"a": 1, "b": 2}</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>merge</code> Merges two or more objects. Rightmost keys
win in case of conflict. * <strong>Syntax:</strong>
<code>["merge", &lt;obj1_expr&gt;, &lt;obj2_expr&gt;, ...]</code> *
<strong>Example:</strong>
<code>["merge", {"a": 1, "b": 1}, {"b": 2, "c": 3}]</code> -&gt;
<code>{"a": 1, "b": 2, "c": 3}</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>permuto.apply</code> Applies a Permuto template to a
context object. * <strong>Syntax:</strong>
<code>["permuto.apply", &lt;template_expr&gt;, &lt;context_expr&gt;]</code>
* <strong>Example:</strong>
<code>["permuto.apply", {"id": "${/user_id}"}, {"user_id": 123}]</code>
-&gt; <code>{"id": 123}</code></td>
</tr>
<tr class="even">
<td>### JSON Patch Operations (RFC 6902)</td>
</tr>
</tbody>
</table>
<h4 id="diff"><code>diff</code></h4>
<p>Generates an RFC 6902 JSON Patch array that describes the differences
between two JSON documents. * <strong>Syntax:</strong>
<code>["diff", &lt;original_document&gt;, &lt;modified_document&gt;]</code>
* <strong>Example:</strong>
<code>["diff", {"status": "active"}, {"status": "archived"}]</code>
-&gt;
<code>[{"op": "replace", "path": "/status", "value": "archived"}]</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>patch</code> Applies an RFC 6902 JSON Patch array to a
document, returning the modified document. * <strong>Syntax:</strong>
<code>["patch", &lt;document_to_patch&gt;, &lt;patch_array&gt;]</code> *
<strong>Example:</strong>
<code>["patch", {"status": "active"}, [{"op": "replace", "path": "/status", "value": "archived"}]]</code>
-&gt; <code>{"status": "archived"}</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>
Performs a mathematical operation on two numbers. *
<strong>Syntax:</strong>
<code>["&lt;op&gt;", &lt;num1_expr&gt;, &lt;num2_expr&gt;]</code> *
<strong>Example:</strong> <code>["*", 5, 10]</code> -&gt;
<code>50</code></td>
</tr>
<tr class="even">
<td>### Array Operators</td>
</tr>
<tr class="odd">
<td><em>Note: For all array operators, literal arrays must be specified
using <code>{"array": [...]}</code> syntax.</em></td>
</tr>
</tbody>
</table>
<h4 id="map"><code>map</code></h4>
<p>Applies a lambda to each item in an array, returning a new array of
transformed items. * <strong>Syntax:</strong>
<code>["map", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;transform_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["map", {"array": [1,2]}, ["lambda",["x"],["+",["$","/x"],1]]]</code>
-&gt; <code>[2, 3]</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>filter</code> Returns a new array containing only items
for which the lambda returns a truthy value. * <strong>Syntax:</strong>
<code>["filter", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;condition_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["filter", {"array": [0,1,2]}, ["lambda",["x"],["$", "/x"]]]</code>
-&gt; <code>[1, 2]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>reduce</code> Reduces an array to a single value by
applying a two-argument lambda. * <strong>Syntax:</strong>
<code>["reduce", &lt;array_expr&gt;, ["lambda", ["acc", "item"], &lt;expr&gt;], &lt;initial_value&gt;]</code>
* <strong>Example:</strong>
<code>["reduce", {"array": [1,2,3]}, ["lambda",["a","i"],["+",["$","/a"],["$","/i"]]], 0]</code>
-&gt; <code>6</code></td>
</tr>
</tbody>
</table>
<h4 id="find"><code>find</code></h4>
<p>Returns the <strong>first item</strong> in an array for which the
lambda returns a truthy value, or <code>null</code> if no match is
found. * <strong>Syntax:</strong>
<code>["find", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;condition_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["find", {"array": [1,5,10]}, ["lambda",["x"],["&gt;",["$","/x"],3]]]</code>
-&gt; <code>5</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>some</code> Returns <code>true</code> if the lambda
returns a truthy value for <strong>at least one item</strong> in the
array, <code>false</code> otherwise. * <strong>Syntax:</strong>
<code>["some", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;condition_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["some", {"array": [1,5,10]}, ["lambda",["x"],["==",["$","/x"],5]]]</code>
-&gt; <code>true</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>every</code> Returns <code>true</code> if the lambda
returns a truthy value for <strong>all items</strong> in the array,
<code>true</code> for an empty array, <code>false</code> otherwise. *
<strong>Syntax:</strong>
<code>["every", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;condition_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["every", {"array": [2,4,6]}, ["lambda",["x"],["==",["%",["$","/x"],2],0]]]</code>
-&gt; <code>true</code></td>
</tr>
</tbody>
</table>
<h4 id="flatmap"><code>flatMap</code></h4>
<p>Like <code>map</code>, but if a lambda returns an array, its items
are flattened into the result array. * <strong>Syntax:</strong>
<code>["flatMap", &lt;array_expr&gt;, ["lambda", ["item_var"], &lt;transform_expr&gt;]]</code>
* <strong>Example:</strong>
<code>["flatMap", {"array": [1,2]}, ["lambda",["x"],{"array":[["$","/x"],["$","/x"]]}]</code>
-&gt; <code>[1, 1, 2, 2]</code></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>#### <code>count</code> Returns the number of items in an array. *
<strong>Syntax:</strong> <code>["count", &lt;array_expr&gt;]</code> *
<strong>Example:</strong> <code>["count", {"array": [1, 2, 3]}]</code>
-&gt; <code>3</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>#### <code>car</code> Returns the first element of an array.
Inspired by Lisp’s car function. * <strong>Syntax:</strong>
<code>["car", &lt;array_expr&gt;]</code> * <strong>Example:</strong>
<code>["car", {"array": [1, 2, 3]}]</code> -&gt; <code>1</code> *
<strong>Note:</strong> Throws <code>InvalidArgumentException</code> if
array is empty or argument is not an array</td>
</tr>
</tbody>
</table>
<h4 id="cdr"><code>cdr</code></h4>
<p>Returns all elements except the first from an array. Inspired by
Lisp’s cdr function. * <strong>Syntax:</strong>
<code>["cdr", &lt;array_expr&gt;]</code> * <strong>Example:</strong>
<code>["cdr", {"array": [1, 2, 3]}]</code> -&gt; <code>[2, 3]</code> *
<strong>Note:</strong> Returns empty array <code>[]</code> if input
array is empty; throws <code>InvalidArgumentException</code> if argument
is not an array</p>
</body>
</html>
